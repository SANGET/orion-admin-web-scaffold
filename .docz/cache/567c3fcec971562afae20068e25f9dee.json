{"remainingRequest":"/Users/AlexZhang/work/uke/uke-admin-web-scaffold/node_modules/babel-loader/lib/index.js?{\"presets\":[[\"/Users/AlexZhang/work/uke/uke-admin-web-scaffold/node_modules/babel-preset-docz/dist/index.js\",{\"flow\":true,\"typescript\":false,\"parseProps\":true}]],\"plugins\":[[\"/Users/AlexZhang/work/uke/uke-admin-web-scaffold/node_modules/docz-utils/lib/named-asset-import.js\",{\"loaderMap\":{\"svg\":{\"ReactComponent\":\"@svgr/webpack?-prettier,-svgo![path]\"}}}],\"/Users/AlexZhang/work/uke/uke-admin-web-scaffold/node_modules/react-hot-loader/babel.js\"],\"env\":{\"development\":{\"presets\":[\"@babel/env\",\"@babel/preset-react\"],\"plugins\":[[\"react-hot-loader/babel\"],\"@babel/plugin-proposal-class-properties\"]},\"production\":{\"presets\":[\"@babel/preset-env\",\"@babel/preset-react\"],\"plugins\":[\"@babel/plugin-proposal-class-properties\"]}},\"babelrc\":false,\"cacheDirectory\":true,\"cacheCompression\":false,\"compact\":false}!/Users/AlexZhang/work/uke/uke-admin-web-scaffold/src/leftmenu/version-com.js","dependencies":[{"path":"/Users/AlexZhang/work/uke/uke-admin-web-scaffold/src/leftmenu/version-com.js","mtime":1543390634435},{"path":"/Users/AlexZhang/work/uke/uke-admin-web-scaffold/node_modules/cache-loader/dist/cjs.js","mtime":1541998094606},{"path":"/Users/AlexZhang/work/uke/uke-admin-web-scaffold/node_modules/babel-loader/lib/index.js","mtime":1541048071011}],"contextDependencies":[],"result":["var _jsxFileName = \"/Users/AlexZhang/work/uke/uke-admin-web-scaffold/src/leftmenu/version-com.js\";\n\n(function () {\n  var enterModule = require('react-hot-loader').enterModule;\n\n  enterModule && enterModule(module);\n})();\n\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Tip } from 'ukelli-ui';\n\nvar VersionDisplayer =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(VersionDisplayer, _Component);\n\n  function VersionDisplayer(props) {\n    var _this;\n\n    _classCallCheck(this, VersionDisplayer);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(VersionDisplayer).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"_clear\", function () {\n      _this.timer && clearInterval(_this.timer);\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"getVersion\", function () {\n      if (_this.errorCount === 5) return _this._clear();\n      fetch($AWT.versionUrl + '?t=' + Date.now()).then(function (res) {\n        return res.json();\n      }).then(function (remoteVersion) {\n        var numberVersion = remoteVersion.numberVersion,\n            updateLog = remoteVersion.updateLog;\n        numberVersion = numberVersion.trim();\n\n        if (numberVersion != _this.state.lastVersion) {\n          _this._clear();\n\n          !_this.__unmount && _this.setState({\n            lastVersion: numberVersion,\n            updateLog: updateLog\n          });\n        }\n      }).catch(function (e) {\n        _this.errorCount++;\n      });\n    });\n\n    var _numberVersion = props.versionInfo.numberVersion;\n    _numberVersion = _numberVersion.trim();\n    _this.errorCount = 0;\n    _this.state = {\n      currVersion: _numberVersion,\n      lastVersion: _numberVersion\n    };\n    return _this;\n  }\n\n  _createClass(VersionDisplayer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getVersion();\n      this.timer = setInterval(this.getVersion, 30 * 60 * 1000);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.__unmount = true;\n\n      this._clear();\n    }\n  }, {\n    key: \"reload\",\n    value: function reload() {\n      location.reload();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          currVersion = _this$state.currVersion,\n          lastVersion = _this$state.lastVersion,\n          updateLog = _this$state.updateLog;\n      var gm = this.props.gm;\n      return React.createElement(\"span\", {\n        className: \"version-container\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }, lastVersion != currVersion ? React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, React.createElement(Tip, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }), React.createElement(\"sup\", {\n        className: \"new-app-version\",\n        onClick: this.reload,\n        title: gm(\"有新版本，点击重新加载，新版本说明: \") + updateLog,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, gm('新版本'), lastVersion)) : null, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, gm('当前版本'), currVersion));\n    }\n  }, {\n    key: \"__reactstandin__regenerateByEval\",\n    // @ts-ignore\n    value: function __reactstandin__regenerateByEval(key, code) {\n      // @ts-ignore\n      this[key] = eval(code);\n    }\n  }]);\n\n  return VersionDisplayer;\n}(Component);\n\n_defineProperty(VersionDisplayer, \"propTypes\", {\n  gm: PropTypes.func.isRequired,\n  versionInfo: PropTypes.object.isRequired\n});\n\nexport { VersionDisplayer as default };\n;\n\n(function () {\n  var reactHotLoader = require('react-hot-loader').default;\n\n  var leaveModule = require('react-hot-loader').leaveModule;\n\n  if (!reactHotLoader) {\n    return;\n  }\n\n  reactHotLoader.register(VersionDisplayer, \"VersionDisplayer\", \"/Users/AlexZhang/work/uke/uke-admin-web-scaffold/src/leftmenu/version-com.js\");\n  leaveModule(module);\n})();\n\n;\nVersionDisplayer.__docgenInfo = {\n  \"description\": \"\",\n  \"methods\": [{\n    \"name\": \"_clear\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [],\n    \"returns\": null\n  }, {\n    \"name\": \"reload\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [],\n    \"returns\": null\n  }, {\n    \"name\": \"getVersion\",\n    \"docblock\": null,\n    \"modifiers\": [],\n    \"params\": [],\n    \"returns\": null\n  }],\n  \"displayName\": \"VersionDisplayer\",\n  \"props\": {\n    \"gm\": {\n      \"type\": {\n        \"name\": \"func\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    },\n    \"versionInfo\": {\n      \"type\": {\n        \"name\": \"object\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    }\n  }\n};",{"version":3,"sources":["/Users/AlexZhang/work/uke/uke-admin-web-scaffold/src/leftmenu/version-com.js"],"names":["React","Component","PropTypes","Tip","VersionDisplayer","props","timer","clearInterval","errorCount","_clear","fetch","$AWT","versionUrl","Date","now","then","res","json","remoteVersion","numberVersion","updateLog","trim","state","lastVersion","__unmount","setState","catch","e","versionInfo","currVersion","getVersion","setInterval","location","reload","gm","func","isRequired","object"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Tip } from 'ukelli-ui';\n\nexport default class VersionDisplayer extends Component {\n  static propTypes = {\n    gm: PropTypes.func.isRequired,\n    versionInfo: PropTypes.object.isRequired,\n  }\n  constructor(props) {\n    super(props);\n\n    let { numberVersion } = props.versionInfo;\n\n    numberVersion = numberVersion.trim();\n    this.errorCount = 0;\n\n    this.state = {\n      currVersion: numberVersion,\n      lastVersion: numberVersion,\n    };\n  }\n\n  componentDidMount() {\n    this.getVersion();\n    this.timer = setInterval(this.getVersion, 30 * 60 * 1000);\n  }\n\n  componentWillUnmount() {\n    this.__unmount = true;\n    this._clear();\n  }\n\n  _clear = () => {\n    this.timer && clearInterval(this.timer);\n  };\n\n  reload() {\n    location.reload();\n  }\n\n  getVersion = () => {\n    if (this.errorCount === 5) return this._clear();\n    fetch($AWT.versionUrl + '?t=' + Date.now())\n      .then(res => res.json())\n      .then(remoteVersion => {\n        let { numberVersion, updateLog } = remoteVersion;\n        numberVersion = numberVersion.trim();\n        if (numberVersion != this.state.lastVersion) {\n          this._clear();\n          !this.__unmount && this.setState({\n            lastVersion: numberVersion,\n            updateLog\n          });\n        }\n      })\n      .catch(e => {\n        this.errorCount++;\n      });\n  };\n\n  render() {\n    const { currVersion, lastVersion, updateLog } = this.state;\n    const { gm } = this.props;\n    return (\n      <span className=\"version-container\">\n        {\n          lastVersion != currVersion ? (\n            <div>\n              <Tip/>\n              <sup\n                className=\"new-app-version\"\n                onClick={this.reload}\n                title={gm(\"有新版本，点击重新加载，新版本说明: \") + updateLog}>\n                {gm('新版本')}\n                {lastVersion}\n              </sup>\n            </div>\n          ) : null\n        }\n        <span>\n          {gm('当前版本')} \n          {currVersion}\n        </span>\n      </span>\n    );\n  }\n}\n"]}]}